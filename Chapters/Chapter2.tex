\chapter{Појам скреповања}\label{ch:\thechapter}
\vspace*{-8mm}
\textit{Овде се, као и у остатку рада, због стила и недостатка боље формулације реч ученик употребљава у граматичком мушком роду. Наравно, овај израз обухвата и све ученице.} %Politička (rodna, kakogod) korektnost over 9000. todo Formulisati ovo lepše
\vspace{5mm}

\section{Шта је скреповање}

Скреповање Веба (енгл. web scrapping, у дословном преводу Веб стругање) подразумева било који поступак којим се подаци из формата који је читљив људима пребацују у формат читљив машинама \citep{boeing2017new}. Веб странице су најчешће писане у HTML-у и CSS-у (од енгл. Hypertext Markup Language и Cascaded Style Sheets), уз опционе процедуралне елементе у Javascript-у, које претраживач чита и приказује кориснику. Садржај се по правилу налази у оквиру HTML или као што ћемо видети у неким случајевима унутар Javascript кода, док CSS носи информацију о изгледу странице. Овај процес је оптималан када су циљна група људи, међутим ови језици су далеко експресивнији и носе значајан вишак информација за потребе анализирања самих података (нпр. начин на који је све визуелно организовано на страници), који треба одстранити. 

\subsection{Методи скреповања}

Најочигледнији метод скреповања је ручни -- тако што човек копира, налепљује и организује одговарајуће податке тако да се они касније могу лако учитати користећи неки програм. Очигледно је да је ово ретко практично, и користи се само када не постоји други избор, или евентуално за мање корекције самих података. Други најједноставнији метод је тражење образаца у тексту/коду и извлачење фрагмената са одговарајућих места (видети, на пример, grep алат на системима базираним на Unix-у и појам регуларних израза). И овај поступак је незадовољавајући када је реч о страницама које се највећим делом састоје од HTML кода и као такве имају велики број сличних образаца у тексту које је тешко разликовати. 

Значајно бољи начин је парсирање HTML-а на начин сличан оном који интернет претраживачи користе, градећи објектни модел (DOM) у меморији у облику стабла кроз које се лако пролази. У овом случају, програмер мора да спецификује како доћи до жељених података (тј. које су особине чвора који се тражи). Неке напредније методе користе вештачку интелигенцију како би што више аутоматизовале овај процес, и у том случају најчешће се говори о методама које анализирају DOM \citep{peters2013content} или које анализирају страницу онако како је она приказана кориснику (тзв. screen scraping) \citep{awsdiffbot}.

\subsection{HTML и DOM}

HTML је језик чији су основни елементи тагови који одређују тип података. Када се тај код машински \enquote{прочита} и интерпретира, добијамо Објектни модел документа (енгл. Document Object Model, или DOM), који у меморији хијерархијски представља све елементе у облику стабла са кореним чвором \emph{document}. Ова структура је много лакша за манипулисање \citep{gupta2003dom}, и овде ће се највише користити за долажење до садржаја конкретног елемента на страници. Објектни модел документа је апстрактни интерфејс који није везан ни за један конкретан језик или платформу \citep{w3domdef}, али ће се у контексту овог рада увек односити на резултат парсирања HTML странице. 

Сваки елемент у HTML-у може носити неке атрибуте, од којих су најбитнији јединствена идентификациона вредност \code{id} и класа елемента \code{class}. (Конкретна синтакса HTML-a нам у овом случају није значајна.) Налажењем идентификационе вредности или неке комбинације класа у стаблу DOM-a можемо доћи до садржаја чвора и жељених података.


\section{Извор података}

Као извор података за скреповање користи се \url{http://upis.mpn.gov.rs}, који је званичан портал Министарства просвете, науке и технолошког развоја посвећен упису у средње школе чији је оснивач Држава, аутономна покрајина или јединица локалне самоуправе \citep{upismpn}. На порталу се могу пронаћи подаци о сваком уписаном ученику (у анонимизираној форми, тј. под шифром) и свакој основној и средњој школи која је део система, али насупрот тврђењу на почетној страници које обећава \emph{све статистичке податке који могу помоћи у одабиру школе} \citep{upismpn} сматрам да се на њему може видети само делић статистичих података који се коришћењем свих изложених података може извести. Овај рад ће пружити примере за неке од њих и начинити базу доступну свима који имају могућности и вољу да дају свој допринос.

\subsection{Структура портала посвећеног упису у средње школе}

Портал је доживео редизајн 2017. године, стога је било потребно направити скрепер (енгл. scraper, у значењу \enquote{алат за стругање}) у две варијанте, односно ажурирати постојећи тако да може да \enquote{разуме} и нову верзију. Основна структура портала је остала иста. Одељак \textit{Подаци о ученицима} омогућава претрагу конкретног ученика по шифри и ово нам за аутоматско преузимање података није од користи пошто може постојати и до милион шифара за мање од седамдесет хиљада ученика колико упише средњу школу сваке године (ову тврдњу ћемо доказати у другом делу, у Глави \ref{ch:5}). Одељак \textit{Основне школе} пружа основне информације о свакој основној школи као што су име, место, број ученика и просечни бројеви бодова на крају разреда и на завршном испиту; ови подаци се прикупљају парцијално од 2016. године, а у пуном облику од 2017-те. 

\textit{Средње школе и образовни профили} је најкориснији одељак за скрепер. Он обухвата, за сваки образовни профил, тј. смер средње школе, списак шифара ученика, број бодова и круг уписа за сваког уписаног ученика. Када знамо шифру ученика, можемо је користити да приступимо страници која садржи податке о конкретном ученику, као што су оцене из свих предмета у завршне три године које се бодују при упису и бодови на завршном испиту. И када се порталу приступа ручно, текст којим је исписана шифра је хиперлинк до странице ученика, тако да је без много муке могуће одратити верификацију појединих записа.

\section{Легалност скреповања}

Када је реч о прикупљању података без експлицитне дозволе, често се помиње легални аспект и да ли је и када то законом дозвољено. Најчешћи аргумент против овакве технике је угрожавање ауторских права или кршење Услова коришћења сајта, и на то треба обратити пажњу, посебно када су у питању платформе које су у приватном власништву и могуће је да имају копирајт или ауторско право над подацима (Србија у свом правном оквиру користи концепт ауторског права). 

У Србији, колико је мени познато, није било већих судских случајева у овој области, а закон који је уређује је Закон о ауторским и сродним правима \citep{autorskaprava}. Конкретно, у случају овог рада, прикупљани подаци се не могу сматрати оригиналном духовном творевином аутора (као што се захтева у чл. 2 Закона). Штавише, они су настали у раду органа јавне власти како је дефинисано у чл. 2 Закона о слободном приступу информацијама од јавног значаја \citep{zospi} у које се по чл. 3 истог закона убрајају и све државне основне и средње школе у Србији, што их чини ван опсега ауторског права а сврстава их у јавно доступне информације. Уз то, они су објављени на званичном сајту Министарства, тако да писање Захтева није неопходно (ово би чак, по чл. 10, био основ за одбијање истог). Такође, нигде на сајту не постоје експлицитно наведени услови употребе и ограничења која би се односила на скреповање, укључујући и robots.txt фајл који се конвенционално користи за истицање правила понашања свих посетилаца који нису људи, већ скрипте и програми у било каквом облику (видети Стандард за искључење робота \citep{robotstxt}).

Треба имати на уму да све технике које су овде описане не експлоатишу никакве рањивости, не приступа се било каквим заштићеним системима, нити постоји било каква имовинска корист. Сви подаци су већ доступни јавно, тако да се њихова употреба не коси са Законом о заштити података о личности, и циљ је само њихова реорганизација у машински читљив формат који је погодан за обраду.